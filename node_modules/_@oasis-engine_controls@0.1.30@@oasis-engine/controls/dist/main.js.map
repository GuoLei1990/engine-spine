{"version":3,"file":"main.js","sources":["../src/FreeControl.ts","../src/OrbitControl.ts"],"sourcesContent":["import { Entity, Logger, MathUtil, Script, Spherical, Vector3 } from \"@alipay/o3\";\nimport { doTransform, Easing, Tween } from \"@alipay/o3-tween\";\n\n// 防止万向锁\nconst ESP = MathUtil.zeroTolerance;\n\nfunction includes(array, ...filterArray) {\n  return filterArray.some((e) => array.indexOf(e) !== -1);\n}\n\nconst tween = new Tween();\n\n/**\n * 相机的的漫游控制器，可以上下左右位移，转转视角。\n */\nexport class FreeControl extends Script {\n  _forward = new Vector3();\n  _right = new Vector3();\n  camera: Entity;\n  mainElement: any;\n  domElement: any;\n\n  /** 每秒运动距离，单位为MVP转换前的单位\n   * @member {number}\n   * */\n  movementSpeed: number;\n\n  /** 一个canvas的高宽度旋转Math.PI* this.rotateSpeed\n   * @member {number}\n   * */\n  rotateSpeed: number;\n\n  /** 模拟一个地面用来jump，替代碰撞体\n   * @member {boolean}\n   * */\n  floorMock: boolean;\n\n  /** 模拟地面高度\n   * @member {number}\n   * */\n  floorY: number;\n\n  /**\n   * the heightY jump to\n   * @member {number}\n   * */\n  jumpY: number;\n\n  /**\n   * the amount of the jumping time, jumpUpDuration+jumpDownDuration\n   * unit:ms\n   * @member {number}\n   * */\n  jumpDuration: number;\n\n  /** only rotate when press=true\n   * @member {boolean}\n   * */\n  press: boolean;\n  keysForward: Array<string | number>;\n  keysBackward: Array<string | number>;\n  keysLeft: Array<string | number>;\n  keysRight: Array<string | number>;\n  keysJump: Array<string | number>;\n\n  /**\n   * radian of spherical.theta\n   * @member {number}\n   * */\n  private _theta: number;\n\n  /**\n   * radian of spherical.phi\n   * @member {number}\n   * */\n  private _phi: number;\n\n  private _moveForward: boolean;\n  private _moveBackward: boolean;\n  private _moveLeft: boolean;\n  private _moveRight: boolean;\n  private _moveJump: boolean;\n\n  private _v3Cache: Vector3;\n  private _spherical: Spherical;\n  private _rotateOri: Array<number>;\n  private _events: Array<{ type: string; listener: () => {}; element?: any }>;\n\n  /**\n   * 漫游控制器构造函数\n   * @param {Entity} entity 挂载节点\n   * @param {Object} props 轨道控制器参数，包含以下项\n   * @property {Canvas|HTMLElement} [props.mainElement=RHI.canvas] 获取事件的HTMLElement对象，推荐使用绘制的canvas\n   * @property {HTMLElement} [props.domElement=document] 获取顶级事件的HTMLElement对象。\n   */\n  constructor(entity: Entity, props: { mainElement?; domElement? }) {\n    super(entity);\n    this.camera = entity;\n    //@ts-ignore @todo 未来移除对html元素的依赖，通过封装引擎的input实现\n    this.mainElement = props.mainElement || this.scene.engine.canvas._webCanvas;\n    this.domElement = props.domElement || document;\n\n    if (!(this.mainElement instanceof HTMLCanvasElement)) {\n      Logger.warn(\"AFreeControls must have a legal mainElement\");\n      return null;\n    }\n    this.movementSpeed = 1.0;\n    this.rotateSpeed = 1.0;\n\n    this.floorMock = true;\n    this.floorY = 0;\n\n    this.jumpY = 1;\n    this.jumpDuration = 600;\n\n    this.press = false;\n\n    this.keysForward = [\"KeyW\", \"ArrowUp\"];\n    this.keysBackward = [\"KeyS\", \"ArrowDown\"];\n    this.keysLeft = [\"KeyA\", \"ArrowLeft\"];\n    this.keysRight = [\"KeyD\", \"ArrowRight\"];\n    this.keysJump = [\"Space\"];\n\n    this._theta = 0;\n    this._phi = 0;\n\n    // private variables\n    this._moveForward = false;\n    this._moveBackward = false;\n    this._moveLeft = false;\n    this._moveRight = false;\n    this._moveJump = false;\n\n    this._v3Cache = new Vector3();\n    this._spherical = new Spherical();\n    this._rotateOri = [0, 0];\n\n    this._events = [\n      { type: \"mousemove\", listener: this.onMouseMove.bind(this) },\n      { type: \"touchmove\", listener: this.onMouseMove.bind(this) },\n      { type: \"mousedown\", listener: this.onMouseDown.bind(this) },\n      { type: \"touchstart\", listener: this.onMouseDown.bind(this) },\n      { type: \"mouseup\", listener: this.onMouseUp.bind(this) },\n      { type: \"touchend\", listener: this.onMouseUp.bind(this) },\n      { type: \"keydown\", listener: this.onKeyDown.bind(this), element: window },\n      { type: \"keyup\", listener: this.onKeyUp.bind(this), element: window },\n      { type: \"contextmenu\", listener: this.onContextMenu.bind(this) }\n    ];\n\n    this.initEvents();\n\n    // init spherical\n    this.updateSpherical();\n  }\n\n  /**\n   * 浏览器右键事件\n   * @private\n   * */\n  onContextMenu(event): void {\n    event.preventDefault();\n  }\n\n  /**\n   * 键盘按下事件\n   * @private\n   * */\n  onKeyDown(event): void {\n    const { code, key, keyCode } = event;\n    if (includes(this.keysForward, code, key, keyCode)) {\n      this._moveForward = true;\n    } else if (includes(this.keysBackward, code, key, keyCode)) {\n      this._moveBackward = true;\n    } else if (includes(this.keysLeft, code, key, keyCode)) {\n      this._moveLeft = true;\n    } else if (includes(this.keysRight, code, key, keyCode)) {\n      this._moveRight = true;\n    } else if (includes(this.keysJump, code, key, keyCode)) {\n      this.jump();\n    }\n  }\n\n  /**\n   * 键盘抬起事件\n   * @private\n   * */\n  onKeyUp(event): void {\n    const { code, key, keyCode } = event;\n    if (includes(this.keysForward, code, key, keyCode)) {\n      this._moveForward = false;\n    } else if (includes(this.keysBackward, code, key, keyCode)) {\n      this._moveBackward = false;\n    } else if (includes(this.keysLeft, code, key, keyCode)) {\n      this._moveLeft = false;\n    } else if (includes(this.keysRight, code, key, keyCode)) {\n      this._moveRight = false;\n    }\n  }\n\n  /**\n   * 手势按下事件\n   * @private\n   * */\n  onMouseDown(event): void {\n    event.stopPropagation();\n    event = (event.changedTouches && event.changedTouches[0]) || event;\n\n    if (this.domElement !== document) {\n      this.domElement.focus();\n    }\n\n    this.press = true;\n    this._rotateOri = [event.clientX, event.clientY];\n  }\n\n  /**\n   * 手势抬起事件\n   * @private\n   * */\n  onMouseUp(event): void {\n    event.preventDefault();\n    event.stopPropagation();\n\n    this.press = false;\n  }\n\n  /**\n   * 手势滑动事件\n   * @private\n   * */\n  onMouseMove(event): void {\n    if (this.press === false) return;\n    if (this.enabled === false) return;\n\n    event.preventDefault();\n    event.stopPropagation();\n    event = (event.changedTouches && event.changedTouches[0]) || event;\n\n    const movementX = event.clientX - this._rotateOri[0];\n    const movementY = event.clientY - this._rotateOri[1];\n    this._rotateOri[0] = event.clientX;\n    this._rotateOri[1] = event.clientY;\n    const factorX = 180 / this.mainElement.width;\n    const factorY = 180 / this.mainElement.height;\n    const actualX = movementX * factorX;\n    const actualY = movementY * factorY;\n\n    this.rotate(-actualX, actualY);\n  }\n\n  /**\n   * 分别绕y轴，x轴旋转的角度\n   * unit:deg\n   * @param {number} alpha - 绕y轴旋转的deg\n   * @param {number} beta - 绕x轴旋转的deg\n   * */\n  rotate(alpha: number = 0, beta: number = 0): void {\n    this._theta += MathUtil.degreeToRadian(alpha);\n    this._phi += MathUtil.degreeToRadian(beta);\n    this._phi = MathUtil.clamp(this._phi, ESP, Math.PI - ESP);\n    this._spherical.theta = this._theta;\n    this._spherical.phi = this._phi;\n    this._spherical.setToVec3(this._v3Cache);\n    Vector3.add(this.camera.position, this._v3Cache, this._v3Cache);\n    this.camera.transform.lookAt(this._v3Cache, new Vector3(0, 1, 0));\n  }\n\n  /**\n   * 跳跃，根据jumpY确定高度，jumpDuration确定时间，floorY确定地面高度\n   * */\n  jump(): void {\n    if (this._moveJump) return;\n\n    this._moveJump = true;\n\n    let p = this.camera.position;\n\n    doTransform\n      .Translate(this.camera, new Vector3(p.x, this.jumpY, p.z), this.jumpDuration / 2, {\n        easing: Easing.easeOutSine,\n        onComplete: () => {\n          doTransform\n            .Translate(this.camera, new Vector3(p.x, this.floorY, p.z), this.jumpDuration / 2, {\n              easing: Easing.easeInSine,\n              onComplete: () => {\n                this._moveJump = false;\n              }\n            })\n            .start(tween);\n        }\n      })\n      .start(tween);\n  }\n\n  /**\n   * transform vec3 on axis by distance\n   * */\n  translateOnAxis(axis: Readonly<Vector3>, distance: number, v3: Readonly<Vector3> = this.camera.position): void {\n    const diff: Vector3 = new Vector3();\n    Vector3.normalize(axis, diff);\n    v3.add(diff.scale(distance));\n  }\n\n  private tempVec3 = new Vector3();\n\n  /**\n   * @override\n   * translate camera per tick\n   * @param  delta - tick gap\n   * */\n  onUpdate(delta: number): void {\n    if (this.enabled === false) return;\n\n    const actualMoveSpeed = (delta / 1000) * this.movementSpeed;\n    this.camera.transform.getWorldForward(this._forward);\n    this.camera.transform.getWorldRight(this._right);\n    if (this._moveForward) {\n      this.translateOnAxis(this._forward, actualMoveSpeed);\n    }\n    if (this._moveBackward) {\n      this.translateOnAxis(this._forward, -actualMoveSpeed);\n    }\n    if (this._moveLeft) {\n      this.translateOnAxis(this._right, -actualMoveSpeed);\n    }\n    if (this._moveRight) {\n      this.translateOnAxis(this._right, actualMoveSpeed);\n    }\n\n    tween.update(delta);\n    const position = this.camera.transform.position;\n\n    if (this.floorMock && !this._moveJump) {\n      // this.camera.position[1] = this.floorY;\n\n      // const pos = this.camera.transform.position;\n      position.setValue(position.x, this.floorY, position.z);\n      this.camera.transform.position = position;\n    }\n  }\n\n  /**注册浏览器事件*/\n  initEvents(): void {\n    this._events.forEach((ele) => {\n      if (ele.element) {\n        ele.element.addEventListener(ele.type, ele.listener, false);\n      } else {\n        this.mainElement.addEventListener(ele.type, ele.listener, false);\n      }\n    });\n  }\n\n  /**\n   * dispose all events\n   * */\n  destroy(): void {\n    this._events.forEach((ele) => {\n      if (ele.element) {\n        ele.element.removeEventListener(ele.type, ele.listener, false);\n      } else {\n        this.mainElement.removeEventListener(ele.type, ele.listener, false);\n      }\n    });\n    super.destroy();\n  }\n\n  /**\n   * must updateSpherical after quaternion has been changed\n   * @example\n   * Entity#lookAt([0,1,0],[0,1,0]);\n   * AFreeControls#updateSpherical();\n   * */\n  updateSpherical(): void {\n    this._v3Cache.setValue(0, 0, -1);\n    Vector3.transformByQuat(this._v3Cache, this.camera.rotation, this._v3Cache);\n    this._spherical.setFromVec3(this._v3Cache);\n    this._theta = this._spherical.theta;\n    this._phi = this._spherical.phi;\n  }\n}\n","\"use strict\";\nimport { Entity, Logger, Matrix, Script, Spherical, Vector2, Vector3 } from \"@alipay/o3\";\n\n/**\n * 相机的的轨道控制器，可以旋转，缩放，平移，支持鼠标和触摸事件。\n */\nexport class OrbitControl extends Script {\n  public camera: Entity;\n  public domElement: HTMLElement | Document;\n  public mainElement: HTMLCanvasElement;\n  public fov: number;\n  public target: Vector3;\n  public up: Vector3;\n  public minDistance: number;\n  public maxDistance: number;\n  public minZoom: number;\n  public maxZoom: number;\n  public enableDamping: boolean;\n  public zoomFactor: number;\n  public enableRotate: boolean;\n  public keyPanSpeed: number;\n  public minPolarAngle: number;\n  public maxPolarAngle: number;\n  public minAzimuthAngle: number;\n  public maxAzimuthAngle: number;\n  public enableZoom: boolean;\n  public dampingFactor: number;\n  public zoomSpeed: number;\n  public enablePan: boolean;\n  public autoRotate: boolean;\n  public autoRotateSpeed: number;\n  public rotateSpeed: number;\n  public enableKeys: boolean;\n  public keys: { LEFT: number; RIGHT: number; UP: number; BOTTOM: number };\n  public mouseButtons: { ORBIT: number; ZOOM: number; PAN: number };\n  public touchFingers: { ORBIT: number; ZOOM: number; PAN: number };\n  private _position: Vector3;\n  private _offset: Vector3;\n  private _spherical: Spherical;\n  private _sphericalDelta: Spherical;\n  private _sphericalDump: Spherical;\n  private _zoomFrag: number;\n  private _scale: number;\n  private _panOffset: Vector3;\n  private _isMouseUp: boolean;\n  private _vPan: Vector3;\n  public constEvents: { listener: any; type: string; element?: Window }[];\n  private _state: any;\n  private _rotateStart: Vector2;\n  private _rotateEnd: Vector2;\n  private _rotateDelta: Vector2;\n  private _panStart: Vector2;\n  private _panEnd: Vector2;\n  private _panDelta: Vector2;\n  private _zoomStart: Vector2;\n  private _zoomEnd: Vector2;\n  private _zoomDelta: Vector2;\n  public STATE: {\n    TOUCH_ROTATE: number;\n    ROTATE: number;\n    TOUCH_PAN: number;\n    ZOOM: number;\n    NONE: number;\n    PAN: number;\n    TOUCH_ZOOM: number;\n  };\n  public mouseUpEvents: { listener: any; type: string }[];\n\n  /**\n   * 轨道控制器构造函数\n   * @param {Entity} entity 挂载节点\n   * @param {Object} props 轨道控制器参数，包含以下项\n   * @property {Canvas|HTMLElement} [props.mainElement=RHI.canvas] 获取事件的HTMLElement对象，推荐使用绘制的canvas\n   * @property {HTMLElement} [props.domElement=document] 获取顶级事件的HTMLElement对象。\n   * @property {fov} [props.fov=45] 透视相机的视场角大小，影响控制器的控制精度\n   * @property {Vector3} [props.target=[0,0,0]] 围绕的目标点，默认原点\n   */\n  constructor(\n    entity: Entity,\n    props?: {\n      domElement?: HTMLElement | Document;\n      fov?: number;\n      target?: Vector3;\n      mainElement?: HTMLCanvasElement;\n    }\n  ) {\n    super(entity);\n\n    this.camera = entity;\n    //@ts-ignore @todo 未来移除对html元素的依赖，通过封装引擎的input实现\n    this.mainElement = props.mainElement || this.scene.engine.canvas._webCanvas;\n    this.domElement = props.domElement || document;\n    this.fov = props.fov || 45;\n\n    if (!(this.mainElement instanceof HTMLCanvasElement)) {\n      Logger.warn(\"OrbitControls must have a legal mainElement\");\n      return null;\n    }\n    // 目标点\n    this.target = props.target || new Vector3();\n\n    // up向量\n    this.up = new Vector3(0, 1, 0);\n\n    // 最大最小距离\n    /**\n     * 最小距离，默认为0.1，应大于0\n     * @member {Number}\n     */\n    this.minDistance = 0.1;\n    /**\n     * 最大距离，默认为无穷，应大于最小距离\n     * @member {Number}\n     */\n    this.maxDistance = Infinity;\n\n    // 最大最小缩放速度\n    /**\n     * 最小缩放速度，默认为0.0\n     * @member {Number}\n     */\n    this.minZoom = 0.0;\n    /**\n     * 最大缩放速度，默认为正无穷\n     * @member {Number}\n     */\n    this.maxZoom = Infinity;\n\n    // 垂直方向旋转范围\n    /**\n     * 垂直方向最小弧度，默认为0弧度，取值范围 0 － Math.PI\n     * @member {Number}\n     */\n    this.minPolarAngle = 0;\n    /**\n     * 垂直方向最大弧度，默认为Math.PI，取值范围 0 － Math.PI\n     * @member {Number}\n     */\n    this.maxPolarAngle = Math.PI;\n\n    // 水平方向旋转范围\n    /**\n     * 垂直方向最小弧度，默认为负无穷\n     * @member {Number}\n     */\n    this.minAzimuthAngle = -Infinity;\n    /**\n     * 垂直方向最小弧度，默认为正无穷\n     * @member {Number}\n     */\n    this.maxAzimuthAngle = Infinity;\n\n    // 缓冲参数\n    /**\n     * 是否开启镜头缓冲，默认为 true\n     * @member {Boolean}\n     */\n    this.enableDamping = true;\n    /**\n     * 旋转缓冲参数，默认为 0.1\n     * @member {Number}\n     */\n    this.dampingFactor = 0.1;\n    /**\n     * 缩放缓冲参数，默认为0.2\n     * @member {Number}\n     */\n    this.zoomFactor = 0.2;\n\n    // 缩放控制\n    /**\n     * 是否启用缩放，默认为true\n     * @member {Boolean}\n     */\n    this.enableZoom = true;\n    /**\n     * 镜头缩放速度，默认为1.0\n     * @member {Number}\n     */\n    this.zoomSpeed = 1.0;\n\n    // 旋转控制\n    /**\n     * 是否开启旋转，默认为true\n     * @member {Boolean}\n     */\n    this.enableRotate = true;\n    /**\n     * 旋转速度，默认为1.0\n     * @member {Number}\n     */\n    this.rotateSpeed = 1.0;\n\n    // 平移控制\n    /**\n     * 是否开启平移，默认为true\n     * @member {Number}\n     */\n    this.enablePan = true;\n    /**\n     * 键盘平移速度，默认为7.0\n     * @member {Number}\n     */\n    this.keyPanSpeed = 7.0;\n\n    // 自动旋转\n    /**\n     * 是否自动旋转镜头，默认为false\n     * @member {Boolean}\n     */\n    this.autoRotate = false;\n    /**\n     * 自动旋转一圈所需的时间，默认为2.0s\n     * @member {Number}\n     */\n    this.autoRotateSpeed = 2.0; // 旋转 2PI 所用的时间 s\n\n    // 键盘平移\n    /**\n     * 是否启用键盘平移，默认为false\n     * @member {Boolean}\n     */\n    this.enableKeys = false;\n    this.keys = {\n      LEFT: 37,\n      UP: 38,\n      RIGHT: 39,\n      BOTTOM: 40\n    };\n\n    // 控制键位\n    this.mouseButtons = {\n      ORBIT: 0,\n      ZOOM: 1,\n      PAN: 2\n    };\n    this.touchFingers = {\n      ORBIT: 1,\n      ZOOM: 2,\n      PAN: 3\n    };\n\n    // 复用对象 防止栈分配过多\n    // update\n    this._position = new Vector3();\n    this._offset = new Vector3();\n    this._spherical = new Spherical();\n    this._sphericalDelta = new Spherical();\n    this._sphericalDump = new Spherical();\n    this._zoomFrag = 0;\n    this._scale = 1;\n    this._panOffset = new Vector3();\n    this._isMouseUp = true;\n\n    // pan\n    this._vPan = new Vector3();\n\n    // state\n    this._rotateStart = new Vector2();\n    this._rotateEnd = new Vector2();\n    this._rotateDelta = new Vector2();\n\n    this._panStart = new Vector2();\n    this._panEnd = new Vector2();\n    this._panDelta = new Vector2();\n\n    this._zoomStart = new Vector2();\n    this._zoomEnd = new Vector2();\n    this._zoomDelta = new Vector2();\n\n    this.STATE = {\n      NONE: -1,\n      ROTATE: 0,\n      ZOOM: 1,\n      PAN: 2,\n      TOUCH_ROTATE: 3,\n      TOUCH_ZOOM: 4,\n      TOUCH_PAN: 5\n    };\n    this._state = this.STATE.NONE;\n\n    this.constEvents = [\n      { type: \"mousedown\", listener: this.onMouseDown.bind(this) },\n      { type: \"wheel\", listener: this.onMouseWheel.bind(this) },\n      { type: \"keydown\", listener: this.onKeyDown.bind(this), element: window },\n      { type: \"touchstart\", listener: this.onTouchStart.bind(this) },\n      { type: \"touchmove\", listener: this.onTouchMove.bind(this) },\n      { type: \"touchend\", listener: this.onTouchEnd.bind(this) },\n      { type: \"contextmenu\", listener: this.onContextMenu.bind(this) }\n    ];\n\n    this.mouseUpEvents = [\n      { type: \"mousemove\", listener: this.onMouseMove.bind(this) },\n      { type: \"mouseup\", listener: this.onMouseUp.bind(this) }\n    ];\n\n    this.constEvents.forEach((ele) => {\n      if (ele.element) {\n        ele.element.addEventListener(ele.type, ele.listener, false);\n      } else {\n        this.mainElement.addEventListener(ele.type, ele.listener, false);\n      }\n    });\n\n    this.addEventListener(\"disabled\", () => {\n      const element = this.domElement === document ? this.domElement.body : this.domElement;\n      this.mainElement.removeEventListener(this.mouseUpEvents[0].type, this.mouseUpEvents[0].listener, false);\n      element.removeEventListener(this.mouseUpEvents[1].type, this.mouseUpEvents[1].listener, false);\n    });\n  }\n\n  /**\n   * 销毁，释放事件监听\n   * @private\n   */\n  destroy() {\n    this.constEvents.forEach((ele) => {\n      if (ele.element) {\n        ele.element.removeEventListener(ele.type, ele.listener, false);\n      } else {\n        this.mainElement.removeEventListener(ele.type, ele.listener, false);\n      }\n    });\n    const element = this.domElement === document ? this.domElement.body : this.domElement;\n    this.mainElement.removeEventListener(this.mouseUpEvents[0].type, this.mouseUpEvents[0].listener, false);\n    element.removeEventListener(this.mouseUpEvents[1].type, this.mouseUpEvents[1].listener, false);\n    super.destroy();\n  }\n\n  /**\n   * 在触屏上用单指控制旋转，三指控制平移\n   */\n  setOneFingerRotate() {\n    this.touchFingers.ORBIT = 1;\n    this.touchFingers.ZOOM = 2;\n    this.touchFingers.PAN = 3;\n  }\n\n  /**\n   * 在触屏上用单指控制平移，三指控制旋转\n   */\n  setOneFingerPan() {\n    this.touchFingers.ORBIT = 3;\n    this.touchFingers.ZOOM = 2;\n    this.touchFingers.PAN = 1;\n  }\n\n  /**\n   * 每帧更新\n   * @private\n   * @param {Number} dtime 和上次绘制的事件间隔 ms\n   */\n  onUpdate(dtime) {\n    if (!this.enabled) return;\n\n    super.onUpdate(dtime);\n\n    const position: Vector3 = this.camera.position;\n    position.cloneTo(this._offset);\n    this._offset.subtract(this.target);\n    this._spherical.setFromVec3(this._offset);\n\n    if (this.autoRotate && this._state === this.STATE.NONE) {\n      this.rotateLeft(this.getAutoRotationAngle(dtime));\n    }\n\n    this._spherical.theta += this._sphericalDelta.theta;\n    this._spherical.phi += this._sphericalDelta.phi;\n\n    this._spherical.theta = Math.max(this.minAzimuthAngle, Math.min(this.maxAzimuthAngle, this._spherical.theta));\n    this._spherical.phi = Math.max(this.minPolarAngle, Math.min(this.maxPolarAngle, this._spherical.phi));\n    this._spherical.makeSafe();\n\n    if (this._scale !== 1) {\n      this._zoomFrag = this._spherical.radius * (this._scale - 1);\n    }\n\n    this._spherical.radius += this._zoomFrag;\n    this._spherical.radius = Math.max(this.minDistance, Math.min(this.maxDistance, this._spherical.radius));\n\n    this.target.add(this._panOffset);\n    this._spherical.setToVec3(this._offset);\n    this.target.cloneTo(this._position);\n    this._position.add(this._offset);\n    this.camera.position = this._position;\n    this.camera.transform.lookAt(this.target, this.up);\n\n    if (this.enableDamping === true) {\n      this._sphericalDump.theta *= 1 - this.dampingFactor;\n      this._sphericalDump.phi *= 1 - this.dampingFactor;\n      this._zoomFrag *= 1 - this.zoomFactor;\n\n      if (this._isMouseUp) {\n        this._sphericalDelta.theta = this._sphericalDump.theta;\n        this._sphericalDelta.phi = this._sphericalDump.phi;\n      } else {\n        this._sphericalDelta.set(0, 0, 0);\n      }\n    } else {\n      this._sphericalDelta.set(0, 0, 0);\n      this._zoomFrag = 0;\n    }\n\n    this._scale = 1;\n    this._panOffset.setValue(0, 0, 0);\n  }\n\n  /**\n   * 获取自动旋转的弧度\n   * @private\n   */\n  getAutoRotationAngle(dtime) {\n    return ((2 * Math.PI) / this.autoRotateSpeed / 1000) * dtime;\n  }\n\n  /**\n   * 获取缩放值\n   * @private\n   */\n  getZoomScale() {\n    return Math.pow(0.95, this.zoomSpeed);\n  }\n\n  /**\n   * 向左旋转一定弧度\n   * @property {Number} radian 旋转的弧度值\n   */\n  rotateLeft(radian) {\n    this._sphericalDelta.theta -= radian;\n    if (this.enableDamping) {\n      this._sphericalDump.theta = -radian;\n    }\n  }\n\n  /**\n   * 向上旋转一定弧度\n   * @property {Number} radian 旋转的弧度值\n   */\n  rotateUp(radian) {\n    this._sphericalDelta.phi -= radian;\n    if (this.enableDamping) {\n      this._sphericalDump.phi = -radian;\n    }\n  }\n\n  /**\n   * 向左平移\n   * @private\n   */\n  panLeft(distance: number, worldMatrix: Matrix) {\n    const e = worldMatrix.elements;\n    this._vPan.setValue(e[0], e[1], e[2]);\n    this._vPan.scale(distance);\n    this._panOffset.add(this._vPan);\n  }\n\n  /**\n   * 向右平移\n   * @private\n   */\n  panUp(distance: number, worldMatrix: Matrix) {\n    const e = worldMatrix.elements;\n    this._vPan.setValue(e[4], e[5], e[6]);\n    this._vPan.scale(distance);\n    this._panOffset.add(this._vPan);\n  }\n\n  /**\n   * 平移\n   * @property {Number} deltaX x方向的平移量，屏幕距离\n   * @property {Number} deltaY y方向的平移量，屏幕距离\n   */\n  pan(deltaX, deltaY) {\n    const element = this.domElement === document ? this.domElement.body : (this.domElement as HTMLElement);\n\n    // perspective only\n    const position: Vector3 = this.camera.position;\n    position.cloneTo(this._vPan);\n    this._vPan.subtract(this.target);\n    let targetDistance = this._vPan.length();\n\n    targetDistance *= (this.fov / 2) * (Math.PI / 180);\n\n    this.panLeft(-2 * deltaX * (targetDistance / element.clientHeight), this.camera.transform.worldMatrix);\n    this.panUp(2 * deltaY * (targetDistance / element.clientHeight), this.camera.transform.worldMatrix);\n  }\n\n  /**\n   * 放大\n   * @private\n   */\n  zoomIn(zoomScale) {\n    // perspective only\n    this._scale *= zoomScale;\n  }\n\n  /**\n   * 缩小\n   * @private\n   */\n  zoomOut(zoomScale) {\n    // perspective only\n    this._scale /= zoomScale;\n  }\n\n  /**\n   * 鼠标点击时旋转参数更新\n   * @private\n   */\n  handleMouseDownRotate(event) {\n    this._rotateStart.setValue(event.clientX, event.clientY);\n  }\n\n  /**\n   * 鼠标点击时缩放参数更新\n   * @private\n   */\n  handleMouseDownZoom(event) {\n    this._zoomStart.setValue(event.clientX, event.clientY);\n  }\n\n  /**\n   * 鼠标点击时平移参数更新\n   * @private\n   */\n  handleMouseDownPan(event) {\n    this._panStart.setValue(event.clientX, event.clientY);\n  }\n\n  /**\n   * 鼠标移动时旋转参数更新\n   * @private\n   */\n  handleMouseMoveRotate(event) {\n    this._rotateEnd.setValue(event.clientX, event.clientY);\n    Vector2.subtract(this._rotateEnd, this._rotateStart, this._rotateDelta);\n\n    const element = this.domElement === document ? document.body : (this.domElement as HTMLElement);\n\n    this.rotateLeft(2 * Math.PI * (this._rotateDelta.x / element.clientWidth) * this.rotateSpeed);\n    this.rotateUp(2 * Math.PI * (this._rotateDelta.y / element.clientHeight) * this.rotateSpeed);\n\n    this._rotateEnd.cloneTo(this._rotateStart);\n  }\n\n  /**\n   * 鼠标移动时缩放参数更新\n   * @private\n   */\n  handleMouseMoveZoom(event) {\n    this._zoomEnd.setValue(event.clientX, event.clientY);\n    Vector2.subtract(this._zoomEnd, this._zoomStart, this._zoomDelta);\n\n    if (this._zoomDelta[1] > 0) {\n      this.zoomOut(this.getZoomScale());\n    } else if (this._zoomDelta[1] < 0) {\n      this.zoomIn(this.getZoomScale());\n    }\n\n    this._zoomEnd.cloneTo(this._zoomStart);\n  }\n\n  /**\n   * 鼠标移动时平移参数更新\n   * @private\n   */\n  handleMouseMovePan(event: MouseEvent): void {\n    this._panEnd.setValue(event.clientX, event.clientY);\n    Vector2.subtract(this._panEnd, this._panStart, this._panDelta);\n\n    this.pan(this._panDelta.x, this._panDelta.y);\n\n    this._panEnd.cloneTo(this._panStart);\n  }\n\n  /**\n   * 鼠标滚轮滚动时缩放参数更新\n   * @private\n   */\n  handleMouseWheel(event: MouseWheelEvent): void {\n    if (event.deltaY < 0) {\n      this.zoomIn(this.getZoomScale());\n    } else if (event.deltaY > 0) {\n      this.zoomOut(this.getZoomScale());\n    }\n  }\n\n  /**\n   * 键盘按下时平移参数更新\n   * @private\n   */\n  handleKeyDown(event: KeyboardEvent) {\n    switch (event.keyCode) {\n      case this.keys.UP:\n        this.pan(0, this.keyPanSpeed);\n        break;\n      case this.keys.BOTTOM:\n        this.pan(0, -this.keyPanSpeed);\n        break;\n      case this.keys.LEFT:\n        this.pan(this.keyPanSpeed, 0);\n        break;\n      case this.keys.RIGHT:\n        this.pan(-this.keyPanSpeed, 0);\n        break;\n    }\n  }\n\n  /**\n   * 触摸落下时旋转参数更新\n   * @private\n   */\n  handleTouchStartRotate(event: TouchEvent) {\n    this._rotateStart.setValue(event.touches[0].pageX, event.touches[0].pageY);\n  }\n\n  /**\n   * 触摸落下时缩放参数更新\n   * @private\n   */\n  handleTouchStartZoom(event: TouchEvent) {\n    const dx = event.touches[0].pageX - event.touches[1].pageX;\n    const dy = event.touches[0].pageY - event.touches[1].pageY;\n\n    const distance = Math.sqrt(dx * dx + dy * dy);\n\n    this._zoomStart.setValue(0, distance);\n  }\n\n  /**\n   * 触摸落下时平移参数更新\n   * @private\n   */\n  handleTouchStartPan(event: TouchEvent) {\n    this._panStart.setValue(event.touches[0].pageX, event.touches[0].pageY);\n  }\n\n  /**\n   * 触摸移动时旋转参数更新\n   * @private\n   */\n  handleTouchMoveRotate(event: TouchEvent) {\n    this._rotateEnd.setValue(event.touches[0].pageX, event.touches[0].pageY);\n    Vector2.subtract(this._rotateEnd, this._rotateStart, this._rotateDelta);\n\n    const element = this.domElement === document ? this.domElement.body : (this.domElement as HTMLElement);\n\n    this.rotateLeft(((2 * Math.PI * this._rotateDelta.x) / element.clientWidth) * this.rotateSpeed);\n    this.rotateUp(((2 * Math.PI * this._rotateDelta.y) / element.clientHeight) * this.rotateSpeed);\n\n    this._rotateEnd.cloneTo(this._rotateStart);\n  }\n\n  /**\n   * 触摸移动时缩放参数更新\n   * @private\n   */\n  handleTouchMoveZoom(event) {\n    const dx = event.touches[0].pageX - event.touches[1].pageX;\n    const dy = event.touches[0].pageY - event.touches[1].pageY;\n\n    const distance = Math.sqrt(dx * dx + dy * dy);\n\n    this._zoomEnd.setValue(0, distance);\n\n    Vector2.subtract(this._zoomEnd, this._zoomStart, this._zoomDelta);\n\n    if (this._zoomDelta[1] > 0) {\n      this.zoomIn(this.getZoomScale());\n    } else if (this._zoomDelta[1] < 0) {\n      this.zoomOut(this.getZoomScale());\n    }\n\n    this._zoomEnd.cloneTo(this._zoomStart);\n  }\n\n  /**\n   * 触摸移动时平移参数更新\n   * @private\n   */\n  handleTouchMovePan(event: TouchEvent) {\n    this._panEnd.setValue(event.touches[0].pageX, event.touches[0].pageY);\n\n    Vector2.subtract(this._panEnd, this._panStart, this._panDelta);\n\n    this.pan(this._panDelta.x, this._panDelta.y);\n\n    this._panEnd.cloneTo(this._panStart);\n  }\n\n  /**\n   * 鼠标按下事件总处理\n   * @private\n   */\n  onMouseDown(event: MouseEvent) {\n    if (this.enabled === false) return;\n\n    event.preventDefault();\n\n    this._isMouseUp = false;\n\n    switch (event.button) {\n      case this.mouseButtons.ORBIT:\n        if (this.enableRotate === false) return;\n\n        this.handleMouseDownRotate(event);\n        this._state = this.STATE.ROTATE;\n        break;\n\n      case this.mouseButtons.ZOOM:\n        if (this.enableZoom === false) return;\n\n        this.handleMouseDownZoom(event);\n        this._state = this.STATE.ZOOM;\n        break;\n\n      case this.mouseButtons.PAN:\n        if (this.enablePan === false) return;\n\n        this.handleMouseDownPan(event);\n        this._state = this.STATE.PAN;\n        break;\n    }\n\n    if (this._state !== this.STATE.NONE) {\n      const element = this.domElement === document ? this.domElement.body : this.domElement;\n      this.mainElement.addEventListener(this.mouseUpEvents[0].type, this.mouseUpEvents[0].listener, false);\n      element.addEventListener(this.mouseUpEvents[1].type, this.mouseUpEvents[1].listener, false);\n    }\n  }\n\n  /**\n   * 鼠标移动事件总处理\n   * @private\n   */\n  onMouseMove(event: MouseEvent) {\n    if (this.enabled === false) return;\n\n    event.preventDefault();\n\n    switch (this._state) {\n      case this.STATE.ROTATE:\n        if (this.enableRotate === false) return;\n\n        this.handleMouseMoveRotate(event);\n        break;\n\n      case this.STATE.ZOOM:\n        if (this.enableZoom === false) return;\n\n        this.handleMouseMoveZoom(event);\n        break;\n\n      case this.STATE.PAN:\n        if (this.enablePan === false) return;\n\n        this.handleMouseMovePan(event);\n        break;\n    }\n  }\n\n  /**\n   * 鼠标抬起事件总处理\n   * @private\n   */\n  onMouseUp() {\n    if (this.enabled === false) return;\n\n    this._isMouseUp = true;\n\n    this.mouseUpEvents.forEach((ele) => {\n      const element = this.domElement === document ? this.domElement.body : this.domElement;\n      element.removeEventListener(ele.type, ele.listener, false);\n      this.mainElement.removeEventListener(ele.type, ele.listener, false);\n    });\n\n    this._state = this.STATE.NONE;\n  }\n\n  /**\n   * 鼠标滚轮滚动事件处理\n   * @private\n   */\n  onMouseWheel(event: MouseWheelEvent) {\n    if (\n      this.enabled === false ||\n      this.enableZoom === false ||\n      (this._state !== this.STATE.NONE && this._state !== this.STATE.ROTATE)\n    )\n      return;\n\n    event.preventDefault();\n    event.stopPropagation();\n\n    this.handleMouseWheel(event);\n  }\n\n  /**\n   * 键盘按下事件总处理\n   * @private\n   */\n  onKeyDown(event: KeyboardEvent) {\n    if (this.enabled === false || this.enableKeys === false || this.enablePan === false) return;\n\n    this.handleKeyDown(event);\n  }\n\n  /**\n   * 触摸按下事件总处理\n   * @private\n   */\n  onTouchStart(event: TouchEvent) {\n    if (this.enabled === false) return;\n\n    this._isMouseUp = false;\n\n    switch (event.touches.length) {\n      case this.touchFingers.ORBIT:\n        if (this.enableRotate === false) return;\n\n        this.handleTouchStartRotate(event);\n        this._state = this.STATE.TOUCH_ROTATE;\n\n        break;\n\n      case this.touchFingers.ZOOM:\n        if (this.enableZoom === false) return;\n\n        this.handleTouchStartZoom(event);\n        this._state = this.STATE.TOUCH_ZOOM;\n\n        break;\n\n      case this.touchFingers.PAN:\n        if (this.enablePan === false) return;\n\n        this.handleTouchStartPan(event);\n        this._state = this.STATE.TOUCH_PAN;\n\n        break;\n\n      default:\n        this._state = this.STATE.NONE;\n    }\n  }\n\n  /**\n   * 触摸移动事件总处理\n   * @private\n   */\n  onTouchMove(event: TouchEvent) {\n    if (this.enabled === false) return;\n\n    event.preventDefault();\n    event.stopPropagation();\n\n    switch (event.touches.length) {\n      case this.touchFingers.ORBIT:\n        if (this.enableRotate === false) return;\n        if (this._state !== this.STATE.TOUCH_ROTATE) return;\n        this.handleTouchMoveRotate(event);\n\n        break;\n\n      case this.touchFingers.ZOOM:\n        if (this.enableZoom === false) return;\n        if (this._state !== this.STATE.TOUCH_ZOOM) return;\n        this.handleTouchMoveZoom(event);\n\n        break;\n\n      case this.touchFingers.PAN:\n        if (this.enablePan === false) return;\n        if (this._state !== this.STATE.TOUCH_PAN) return;\n        this.handleTouchMovePan(event);\n\n        break;\n\n      default:\n        this._state = this.STATE.NONE;\n    }\n  }\n\n  /**\n   * 触摸抬起事件总处理\n   * @private\n   */\n  onTouchEnd() {\n    if (this.enabled === false) return;\n\n    this._isMouseUp = true;\n    this._state = this.STATE.NONE;\n  }\n\n  /**\n   * 上下文事件隐藏\n   * @private\n   */\n  onContextMenu(event) {\n    if (this.enabled === false) return;\n    event.preventDefault();\n  }\n}\n"],"names":["ESP","MathUtil","zeroTolerance","includes","array","filterArray","some","e","indexOf","tween","Tween","FreeControl","entity","props","_forward","Vector3","_right","camera","mainElement","domElement","movementSpeed","rotateSpeed","floorMock","floorY","jumpY","jumpDuration","press","keysForward","keysBackward","keysLeft","keysRight","keysJump","_theta","_phi","_moveForward","_moveBackward","_moveLeft","_moveRight","_moveJump","_v3Cache","_spherical","_rotateOri","_events","tempVec3","scene","engine","canvas","_webCanvas","document","HTMLCanvasElement","Logger","warn","Spherical","type","listener","onMouseMove","bind","onMouseDown","onMouseUp","onKeyDown","element","window","onKeyUp","onContextMenu","initEvents","updateSpherical","event","preventDefault","code","key","keyCode","jump","stopPropagation","changedTouches","focus","clientX","clientY","enabled","movementX","movementY","factorX","width","factorY","height","actualX","actualY","rotate","alpha","beta","degreeToRadian","clamp","Math","PI","theta","phi","setToVec3","add","position","transform","lookAt","p","doTransform","Translate","x","z","easing","Easing","easeOutSine","onComplete","easeInSine","start","axis","distance","v3","diff","normalize","scale","delta","actualMoveSpeed","getWorldForward","getWorldRight","translateOnAxis","update","setValue","forEach","ele","addEventListener","removeEventListener","transformByQuat","rotation","setFromVec3","Script","OrbitControl","fov","target","up","minDistance","maxDistance","minZoom","maxZoom","enableDamping","zoomFactor","enableRotate","keyPanSpeed","minPolarAngle","maxPolarAngle","minAzimuthAngle","maxAzimuthAngle","enableZoom","dampingFactor","zoomSpeed","enablePan","autoRotate","autoRotateSpeed","enableKeys","keys","mouseButtons","touchFingers","_position","_offset","_sphericalDelta","_sphericalDump","_zoomFrag","_scale","_panOffset","_isMouseUp","_vPan","constEvents","_state","_rotateStart","_rotateEnd","_rotateDelta","_panStart","_panEnd","_panDelta","_zoomStart","_zoomEnd","_zoomDelta","STATE","mouseUpEvents","Infinity","LEFT","UP","RIGHT","BOTTOM","ORBIT","ZOOM","PAN","Vector2","NONE","ROTATE","TOUCH_ROTATE","TOUCH_ZOOM","TOUCH_PAN","onMouseWheel","onTouchStart","onTouchMove","onTouchEnd","body","dtime","cloneTo","subtract","rotateLeft","getAutoRotationAngle","max","min","makeSafe","radius","set","pow","radian","worldMatrix","elements","deltaX","deltaY","targetDistance","length","panLeft","clientHeight","panUp","zoomScale","clientWidth","rotateUp","y","zoomOut","getZoomScale","zoomIn","pan","touches","pageX","pageY","dx","dy","sqrt","button","handleMouseDownRotate","handleMouseDownZoom","handleMouseDownPan","handleMouseMoveRotate","handleMouseMoveZoom","handleMouseMovePan","handleMouseWheel","handleKeyDown","handleTouchStartRotate","handleTouchStartZoom","handleTouchStartPan","handleTouchMoveRotate","handleTouchMoveZoom","handleTouchMovePan"],"mappings":"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"}