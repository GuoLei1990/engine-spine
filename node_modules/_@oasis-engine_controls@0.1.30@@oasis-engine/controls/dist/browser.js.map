{"version":3,"file":"browser.js","sources":["../src/FreeControl.ts","../src/OrbitControl.ts"],"sourcesContent":["import { Entity, Logger, MathUtil, Script, Spherical, Vector3 } from \"oasis-engine\";\nimport { doTransform, Easing, Tween } from \"@oasis-engine/tween\";\n\n// 防止万向锁\nconst ESP = MathUtil.zeroTolerance;\n\nfunction includes(array, ...filterArray) {\n  return filterArray.some((e) => array.indexOf(e) !== -1);\n}\n\nconst tween = new Tween();\n\n/**\n * 相机的的漫游控制器，可以上下左右位移，转转视角。\n */\nexport class FreeControl extends Script {\n  _forward = new Vector3();\n  _right = new Vector3();\n  camera: Entity;\n  mainElement: any;\n  domElement: any;\n\n  /** 每秒运动距离，单位为MVP转换前的单位\n   * @member {number}\n   * */\n  movementSpeed: number;\n\n  /** 一个canvas的高宽度旋转Math.PI* this.rotateSpeed\n   * @member {number}\n   * */\n  rotateSpeed: number;\n\n  /** 模拟一个地面用来jump，替代碰撞体\n   * @member {boolean}\n   * */\n  floorMock: boolean;\n\n  /** 模拟地面高度\n   * @member {number}\n   * */\n  floorY: number;\n\n  /**\n   * the heightY jump to\n   * @member {number}\n   * */\n  jumpY: number;\n\n  /**\n   * the amount of the jumping time, jumpUpDuration+jumpDownDuration\n   * unit:ms\n   * @member {number}\n   * */\n  jumpDuration: number;\n\n  /** only rotate when press=true\n   * @member {boolean}\n   * */\n  press: boolean;\n  keysForward: Array<string | number>;\n  keysBackward: Array<string | number>;\n  keysLeft: Array<string | number>;\n  keysRight: Array<string | number>;\n  keysJump: Array<string | number>;\n\n  /**\n   * radian of spherical.theta\n   * @member {number}\n   * */\n  private _theta: number;\n\n  /**\n   * radian of spherical.phi\n   * @member {number}\n   * */\n  private _phi: number;\n\n  private _moveForward: boolean;\n  private _moveBackward: boolean;\n  private _moveLeft: boolean;\n  private _moveRight: boolean;\n  private _moveJump: boolean;\n\n  private _v3Cache: Vector3;\n  private _spherical: Spherical;\n  private _rotateOri: Array<number>;\n  private _events: Array<{ type: string; listener: () => {}; element?: any }>;\n\n  /**\n   * 漫游控制器构造函数\n   * @param {Entity} entity 挂载节点\n   */\n  constructor(entity: Entity) {\n    super(entity);\n    this.camera = entity;\n    //@ts-ignore @todo 未来移除对html元素的依赖，通过封装引擎的input实现\n    this.mainElement = this.scene.engine.canvas._webCanvas;\n    this.domElement = document;\n\n    this.movementSpeed = 1.0;\n    this.rotateSpeed = 1.0;\n\n    this.floorMock = true;\n    this.floorY = 0;\n\n    this.jumpY = 1;\n    this.jumpDuration = 600;\n\n    this.press = false;\n\n    this.keysForward = [\"KeyW\", \"ArrowUp\"];\n    this.keysBackward = [\"KeyS\", \"ArrowDown\"];\n    this.keysLeft = [\"KeyA\", \"ArrowLeft\"];\n    this.keysRight = [\"KeyD\", \"ArrowRight\"];\n    this.keysJump = [\"Space\"];\n\n    this._theta = 0;\n    this._phi = 0;\n\n    // private variables\n    this._moveForward = false;\n    this._moveBackward = false;\n    this._moveLeft = false;\n    this._moveRight = false;\n    this._moveJump = false;\n\n    this._v3Cache = new Vector3();\n    this._spherical = new Spherical();\n    this._rotateOri = [0, 0];\n\n    this._events = [\n      { type: \"mousemove\", listener: this.onMouseMove.bind(this) },\n      { type: \"touchmove\", listener: this.onMouseMove.bind(this) },\n      { type: \"mousedown\", listener: this.onMouseDown.bind(this) },\n      { type: \"touchstart\", listener: this.onMouseDown.bind(this) },\n      { type: \"mouseup\", listener: this.onMouseUp.bind(this) },\n      { type: \"touchend\", listener: this.onMouseUp.bind(this) },\n      { type: \"keydown\", listener: this.onKeyDown.bind(this), element: window },\n      { type: \"keyup\", listener: this.onKeyUp.bind(this), element: window },\n      { type: \"contextmenu\", listener: this.onContextMenu.bind(this) }\n    ];\n\n    this.initEvents();\n\n    // init spherical\n    this.updateSpherical();\n  }\n\n  /**\n   * 浏览器右键事件\n   * @private\n   * */\n  onContextMenu(event): void {\n    event.preventDefault();\n  }\n\n  /**\n   * 键盘按下事件\n   * @private\n   * */\n  onKeyDown(event): void {\n    const { code, key, keyCode } = event;\n    if (includes(this.keysForward, code, key, keyCode)) {\n      this._moveForward = true;\n    } else if (includes(this.keysBackward, code, key, keyCode)) {\n      this._moveBackward = true;\n    } else if (includes(this.keysLeft, code, key, keyCode)) {\n      this._moveLeft = true;\n    } else if (includes(this.keysRight, code, key, keyCode)) {\n      this._moveRight = true;\n    } else if (includes(this.keysJump, code, key, keyCode)) {\n      this.jump();\n    }\n  }\n\n  /**\n   * 键盘抬起事件\n   * @private\n   * */\n  onKeyUp(event): void {\n    const { code, key, keyCode } = event;\n    if (includes(this.keysForward, code, key, keyCode)) {\n      this._moveForward = false;\n    } else if (includes(this.keysBackward, code, key, keyCode)) {\n      this._moveBackward = false;\n    } else if (includes(this.keysLeft, code, key, keyCode)) {\n      this._moveLeft = false;\n    } else if (includes(this.keysRight, code, key, keyCode)) {\n      this._moveRight = false;\n    }\n  }\n\n  /**\n   * 手势按下事件\n   * @private\n   * */\n  onMouseDown(event): void {\n    event.stopPropagation();\n    event = (event.changedTouches && event.changedTouches[0]) || event;\n\n    if (this.domElement !== document) {\n      this.domElement.focus();\n    }\n\n    this.press = true;\n    this._rotateOri = [event.clientX, event.clientY];\n  }\n\n  /**\n   * 手势抬起事件\n   * @private\n   * */\n  onMouseUp(event): void {\n    event.preventDefault();\n    event.stopPropagation();\n\n    this.press = false;\n  }\n\n  /**\n   * 手势滑动事件\n   * @private\n   * */\n  onMouseMove(event): void {\n    if (this.press === false) return;\n    if (this.enabled === false) return;\n\n    event.preventDefault();\n    event.stopPropagation();\n    event = (event.changedTouches && event.changedTouches[0]) || event;\n\n    const movementX = event.clientX - this._rotateOri[0];\n    const movementY = event.clientY - this._rotateOri[1];\n    this._rotateOri[0] = event.clientX;\n    this._rotateOri[1] = event.clientY;\n    const factorX = 180 / this.mainElement.width;\n    const factorY = 180 / this.mainElement.height;\n    const actualX = movementX * factorX;\n    const actualY = movementY * factorY;\n\n    this.rotate(-actualX, actualY);\n  }\n\n  /**\n   * 分别绕y轴，x轴旋转的角度\n   * unit:deg\n   * @param {number} alpha - 绕y轴旋转的deg\n   * @param {number} beta - 绕x轴旋转的deg\n   * */\n  rotate(alpha: number = 0, beta: number = 0): void {\n    this._theta += MathUtil.degreeToRadian(alpha);\n    this._phi += MathUtil.degreeToRadian(beta);\n    this._phi = MathUtil.clamp(this._phi, ESP, Math.PI - ESP);\n    this._spherical.theta = this._theta;\n    this._spherical.phi = this._phi;\n    this._spherical.setToVec3(this._v3Cache);\n    Vector3.add(this.camera.position, this._v3Cache, this._v3Cache);\n    this.camera.transform.lookAt(this._v3Cache, new Vector3(0, 1, 0));\n  }\n\n  /**\n   * 跳跃，根据jumpY确定高度，jumpDuration确定时间，floorY确定地面高度\n   * */\n  jump(): void {\n    if (this._moveJump) return;\n\n    this._moveJump = true;\n\n    let p = this.camera.position;\n\n    doTransform\n      .Translate(this.camera, new Vector3(p.x, this.jumpY, p.z), this.jumpDuration / 2, {\n        easing: Easing.easeOutSine,\n        onComplete: () => {\n          doTransform\n            .Translate(this.camera, new Vector3(p.x, this.floorY, p.z), this.jumpDuration / 2, {\n              easing: Easing.easeInSine,\n              onComplete: () => {\n                this._moveJump = false;\n              }\n            })\n            .start(tween);\n        }\n      })\n      .start(tween);\n  }\n\n  /**\n   * transform vec3 on axis by distance\n   * */\n  translateOnAxis(axis: Readonly<Vector3>, distance: number, v3: Readonly<Vector3> = this.camera.position): void {\n    const diff: Vector3 = new Vector3();\n    Vector3.normalize(axis, diff);\n    v3.add(diff.scale(distance));\n  }\n\n  private tempVec3 = new Vector3();\n\n  /**\n   * @override\n   * translate camera per tick\n   * @param  delta - tick gap\n   * */\n  onUpdate(delta: number): void {\n    if (this.enabled === false) return;\n\n    const actualMoveSpeed = (delta / 1000) * this.movementSpeed;\n    this.camera.transform.getWorldForward(this._forward);\n    this.camera.transform.getWorldRight(this._right);\n    if (this._moveForward) {\n      this.translateOnAxis(this._forward, actualMoveSpeed);\n    }\n    if (this._moveBackward) {\n      this.translateOnAxis(this._forward, -actualMoveSpeed);\n    }\n    if (this._moveLeft) {\n      this.translateOnAxis(this._right, -actualMoveSpeed);\n    }\n    if (this._moveRight) {\n      this.translateOnAxis(this._right, actualMoveSpeed);\n    }\n\n    tween.update(delta);\n    const position = this.camera.transform.position;\n\n    if (this.floorMock && !this._moveJump) {\n      // this.camera.position[1] = this.floorY;\n\n      // const pos = this.camera.transform.position;\n      position.setValue(position.x, this.floorY, position.z);\n      this.camera.transform.position = position;\n    }\n  }\n\n  /**注册浏览器事件*/\n  initEvents(): void {\n    this._events.forEach((ele) => {\n      if (ele.element) {\n        ele.element.addEventListener(ele.type, ele.listener, false);\n      } else {\n        this.mainElement.addEventListener(ele.type, ele.listener, false);\n      }\n    });\n  }\n\n  /**\n   * dispose all events\n   * */\n  destroy(): void {\n    this._events.forEach((ele) => {\n      if (ele.element) {\n        ele.element.removeEventListener(ele.type, ele.listener, false);\n      } else {\n        this.mainElement.removeEventListener(ele.type, ele.listener, false);\n      }\n    });\n    super.destroy();\n  }\n\n  /**\n   * must updateSpherical after quaternion has been changed\n   * @example\n   * Entity#lookAt([0,1,0],[0,1,0]);\n   * AFreeControls#updateSpherical();\n   * */\n  updateSpherical(): void {\n    this._v3Cache.setValue(0, 0, -1);\n    Vector3.transformByQuat(this._v3Cache, this.camera.rotation, this._v3Cache);\n    this._spherical.setFromVec3(this._v3Cache);\n    this._theta = this._spherical.theta;\n    this._phi = this._spherical.phi;\n  }\n}\n","\"use strict\";\nimport { Entity, Logger, Matrix, Script, Spherical, Vector2, Vector3 } from \"oasis-engine\";\n\n/**\n * 相机的的轨道控制器，可以旋转，缩放，平移，支持鼠标和触摸事件。\n */\nexport class OrbitControl extends Script {\n  public camera: Entity;\n  public domElement: HTMLElement | Document;\n  public mainElement: HTMLCanvasElement;\n  public fov: number;\n  public target: Vector3;\n  public up: Vector3;\n  public minDistance: number;\n  public maxDistance: number;\n  public minZoom: number;\n  public maxZoom: number;\n  public enableDamping: boolean;\n  public zoomFactor: number;\n  public enableRotate: boolean;\n  public keyPanSpeed: number;\n  public minPolarAngle: number;\n  public maxPolarAngle: number;\n  public minAzimuthAngle: number;\n  public maxAzimuthAngle: number;\n  public enableZoom: boolean;\n  public dampingFactor: number;\n  public zoomSpeed: number;\n  public enablePan: boolean;\n  public autoRotate: boolean;\n  public autoRotateSpeed: number;\n  public rotateSpeed: number;\n  public enableKeys: boolean;\n  public keys: { LEFT: number; RIGHT: number; UP: number; BOTTOM: number };\n  public mouseButtons: { ORBIT: number; ZOOM: number; PAN: number };\n  public touchFingers: { ORBIT: number; ZOOM: number; PAN: number };\n  private _position: Vector3;\n  private _offset: Vector3;\n  private _spherical: Spherical;\n  private _sphericalDelta: Spherical;\n  private _sphericalDump: Spherical;\n  private _zoomFrag: number;\n  private _scale: number;\n  private _panOffset: Vector3;\n  private _isMouseUp: boolean;\n  private _vPan: Vector3;\n  public constEvents: { listener: any; type: string; element?: Window }[];\n  private _state: any;\n  private _rotateStart: Vector2;\n  private _rotateEnd: Vector2;\n  private _rotateDelta: Vector2;\n  private _panStart: Vector2;\n  private _panEnd: Vector2;\n  private _panDelta: Vector2;\n  private _zoomStart: Vector2;\n  private _zoomEnd: Vector2;\n  private _zoomDelta: Vector2;\n  public STATE: {\n    TOUCH_ROTATE: number;\n    ROTATE: number;\n    TOUCH_PAN: number;\n    ZOOM: number;\n    NONE: number;\n    PAN: number;\n    TOUCH_ZOOM: number;\n  };\n  public mouseUpEvents: { listener: any; type: string }[];\n\n  /**\n   * 轨道控制器构造函数\n   * @param {Entity} entity 挂载节点\n   */\n  constructor(entity: Entity) {\n    super(entity);\n\n    this.camera = entity;\n    //@ts-ignore @todo 未来移除对html元素的依赖，通过封装引擎的input实现\n    this.mainElement = this.engine.canvas._webCanvas;\n    this.domElement = document;\n    this.fov = 45;\n\n    // 目标点\n    this.target = new Vector3();\n\n    // up向量\n    this.up = new Vector3(0, 1, 0);\n\n    // 最大最小距离\n    /**\n     * 最小距离，默认为0.1，应大于0\n     * @member {Number}\n     */\n    this.minDistance = 0.1;\n    /**\n     * 最大距离，默认为无穷，应大于最小距离\n     * @member {Number}\n     */\n    this.maxDistance = Infinity;\n\n    // 最大最小缩放速度\n    /**\n     * 最小缩放速度，默认为0.0\n     * @member {Number}\n     */\n    this.minZoom = 0.0;\n    /**\n     * 最大缩放速度，默认为正无穷\n     * @member {Number}\n     */\n    this.maxZoom = Infinity;\n\n    // 垂直方向旋转范围\n    /**\n     * 垂直方向最小弧度，默认为0弧度，取值范围 0 － Math.PI\n     * @member {Number}\n     */\n    this.minPolarAngle = 0;\n    /**\n     * 垂直方向最大弧度，默认为Math.PI，取值范围 0 － Math.PI\n     * @member {Number}\n     */\n    this.maxPolarAngle = Math.PI;\n\n    // 水平方向旋转范围\n    /**\n     * 垂直方向最小弧度，默认为负无穷\n     * @member {Number}\n     */\n    this.minAzimuthAngle = -Infinity;\n    /**\n     * 垂直方向最小弧度，默认为正无穷\n     * @member {Number}\n     */\n    this.maxAzimuthAngle = Infinity;\n\n    // 缓冲参数\n    /**\n     * 是否开启镜头缓冲，默认为 true\n     * @member {Boolean}\n     */\n    this.enableDamping = true;\n    /**\n     * 旋转缓冲参数，默认为 0.1\n     * @member {Number}\n     */\n    this.dampingFactor = 0.1;\n    /**\n     * 缩放缓冲参数，默认为0.2\n     * @member {Number}\n     */\n    this.zoomFactor = 0.2;\n\n    // 缩放控制\n    /**\n     * 是否启用缩放，默认为true\n     * @member {Boolean}\n     */\n    this.enableZoom = true;\n    /**\n     * 镜头缩放速度，默认为1.0\n     * @member {Number}\n     */\n    this.zoomSpeed = 1.0;\n\n    // 旋转控制\n    /**\n     * 是否开启旋转，默认为true\n     * @member {Boolean}\n     */\n    this.enableRotate = true;\n    /**\n     * 旋转速度，默认为1.0\n     * @member {Number}\n     */\n    this.rotateSpeed = 1.0;\n\n    // 平移控制\n    /**\n     * 是否开启平移，默认为true\n     * @member {Number}\n     */\n    this.enablePan = true;\n    /**\n     * 键盘平移速度，默认为7.0\n     * @member {Number}\n     */\n    this.keyPanSpeed = 7.0;\n\n    // 自动旋转\n    /**\n     * 是否自动旋转镜头，默认为false\n     * @member {Boolean}\n     */\n    this.autoRotate = false;\n    /**\n     * 自动旋转一圈所需的时间，默认为2.0s\n     * @member {Number}\n     */\n    this.autoRotateSpeed = 2.0; // 旋转 2PI 所用的时间 s\n\n    // 键盘平移\n    /**\n     * 是否启用键盘平移，默认为false\n     * @member {Boolean}\n     */\n    this.enableKeys = false;\n    this.keys = {\n      LEFT: 37,\n      UP: 38,\n      RIGHT: 39,\n      BOTTOM: 40\n    };\n\n    // 控制键位\n    this.mouseButtons = {\n      ORBIT: 0,\n      ZOOM: 1,\n      PAN: 2\n    };\n    this.touchFingers = {\n      ORBIT: 1,\n      ZOOM: 2,\n      PAN: 3\n    };\n\n    // 复用对象 防止栈分配过多\n    // update\n    this._position = new Vector3();\n    this._offset = new Vector3();\n    this._spherical = new Spherical();\n    this._sphericalDelta = new Spherical();\n    this._sphericalDump = new Spherical();\n    this._zoomFrag = 0;\n    this._scale = 1;\n    this._panOffset = new Vector3();\n    this._isMouseUp = true;\n\n    // pan\n    this._vPan = new Vector3();\n\n    // state\n    this._rotateStart = new Vector2();\n    this._rotateEnd = new Vector2();\n    this._rotateDelta = new Vector2();\n\n    this._panStart = new Vector2();\n    this._panEnd = new Vector2();\n    this._panDelta = new Vector2();\n\n    this._zoomStart = new Vector2();\n    this._zoomEnd = new Vector2();\n    this._zoomDelta = new Vector2();\n\n    this.STATE = {\n      NONE: -1,\n      ROTATE: 0,\n      ZOOM: 1,\n      PAN: 2,\n      TOUCH_ROTATE: 3,\n      TOUCH_ZOOM: 4,\n      TOUCH_PAN: 5\n    };\n    this._state = this.STATE.NONE;\n\n    this.constEvents = [\n      { type: \"mousedown\", listener: this.onMouseDown.bind(this) },\n      { type: \"wheel\", listener: this.onMouseWheel.bind(this) },\n      { type: \"keydown\", listener: this.onKeyDown.bind(this), element: window },\n      { type: \"touchstart\", listener: this.onTouchStart.bind(this) },\n      { type: \"touchmove\", listener: this.onTouchMove.bind(this) },\n      { type: \"touchend\", listener: this.onTouchEnd.bind(this) },\n      { type: \"contextmenu\", listener: this.onContextMenu.bind(this) }\n    ];\n\n    this.mouseUpEvents = [\n      { type: \"mousemove\", listener: this.onMouseMove.bind(this) },\n      { type: \"mouseup\", listener: this.onMouseUp.bind(this) }\n    ];\n\n    this.constEvents.forEach((ele) => {\n      if (ele.element) {\n        ele.element.addEventListener(ele.type, ele.listener, false);\n      } else {\n        this.mainElement.addEventListener(ele.type, ele.listener, false);\n      }\n    });\n\n    this.addEventListener(\"disabled\", () => {\n      const element = this.domElement === document ? this.domElement.body : this.domElement;\n      this.mainElement.removeEventListener(this.mouseUpEvents[0].type, this.mouseUpEvents[0].listener, false);\n      element.removeEventListener(this.mouseUpEvents[1].type, this.mouseUpEvents[1].listener, false);\n    });\n  }\n\n  /**\n   * 销毁，释放事件监听\n   * @private\n   */\n  destroy() {\n    this.constEvents.forEach((ele) => {\n      if (ele.element) {\n        ele.element.removeEventListener(ele.type, ele.listener, false);\n      } else {\n        this.mainElement.removeEventListener(ele.type, ele.listener, false);\n      }\n    });\n    const element = this.domElement === document ? this.domElement.body : this.domElement;\n    this.mainElement.removeEventListener(this.mouseUpEvents[0].type, this.mouseUpEvents[0].listener, false);\n    element.removeEventListener(this.mouseUpEvents[1].type, this.mouseUpEvents[1].listener, false);\n    super.destroy();\n  }\n\n  /**\n   * 在触屏上用单指控制旋转，三指控制平移\n   */\n  setOneFingerRotate() {\n    this.touchFingers.ORBIT = 1;\n    this.touchFingers.ZOOM = 2;\n    this.touchFingers.PAN = 3;\n  }\n\n  /**\n   * 在触屏上用单指控制平移，三指控制旋转\n   */\n  setOneFingerPan() {\n    this.touchFingers.ORBIT = 3;\n    this.touchFingers.ZOOM = 2;\n    this.touchFingers.PAN = 1;\n  }\n\n  /**\n   * 每帧更新\n   * @private\n   * @param {Number} dtime 和上次绘制的事件间隔 ms\n   */\n  onUpdate(dtime) {\n    if (!this.enabled) return;\n\n    super.onUpdate(dtime);\n\n    const position: Vector3 = this.camera.position;\n    position.cloneTo(this._offset);\n    this._offset.subtract(this.target);\n    this._spherical.setFromVec3(this._offset);\n\n    if (this.autoRotate && this._state === this.STATE.NONE) {\n      this.rotateLeft(this.getAutoRotationAngle(dtime));\n    }\n\n    this._spherical.theta += this._sphericalDelta.theta;\n    this._spherical.phi += this._sphericalDelta.phi;\n\n    this._spherical.theta = Math.max(this.minAzimuthAngle, Math.min(this.maxAzimuthAngle, this._spherical.theta));\n    this._spherical.phi = Math.max(this.minPolarAngle, Math.min(this.maxPolarAngle, this._spherical.phi));\n    this._spherical.makeSafe();\n\n    if (this._scale !== 1) {\n      this._zoomFrag = this._spherical.radius * (this._scale - 1);\n    }\n\n    this._spherical.radius += this._zoomFrag;\n    this._spherical.radius = Math.max(this.minDistance, Math.min(this.maxDistance, this._spherical.radius));\n\n    this.target.add(this._panOffset);\n    this._spherical.setToVec3(this._offset);\n    this.target.cloneTo(this._position);\n    this._position.add(this._offset);\n    this.camera.position = this._position;\n    this.camera.transform.lookAt(this.target, this.up);\n\n    if (this.enableDamping === true) {\n      this._sphericalDump.theta *= 1 - this.dampingFactor;\n      this._sphericalDump.phi *= 1 - this.dampingFactor;\n      this._zoomFrag *= 1 - this.zoomFactor;\n\n      if (this._isMouseUp) {\n        this._sphericalDelta.theta = this._sphericalDump.theta;\n        this._sphericalDelta.phi = this._sphericalDump.phi;\n      } else {\n        this._sphericalDelta.set(0, 0, 0);\n      }\n    } else {\n      this._sphericalDelta.set(0, 0, 0);\n      this._zoomFrag = 0;\n    }\n\n    this._scale = 1;\n    this._panOffset.setValue(0, 0, 0);\n  }\n\n  /**\n   * 获取自动旋转的弧度\n   * @private\n   */\n  getAutoRotationAngle(dtime) {\n    return ((2 * Math.PI) / this.autoRotateSpeed / 1000) * dtime;\n  }\n\n  /**\n   * 获取缩放值\n   * @private\n   */\n  getZoomScale() {\n    return Math.pow(0.95, this.zoomSpeed);\n  }\n\n  /**\n   * 向左旋转一定弧度\n   * @property {Number} radian 旋转的弧度值\n   */\n  rotateLeft(radian) {\n    this._sphericalDelta.theta -= radian;\n    if (this.enableDamping) {\n      this._sphericalDump.theta = -radian;\n    }\n  }\n\n  /**\n   * 向上旋转一定弧度\n   * @property {Number} radian 旋转的弧度值\n   */\n  rotateUp(radian) {\n    this._sphericalDelta.phi -= radian;\n    if (this.enableDamping) {\n      this._sphericalDump.phi = -radian;\n    }\n  }\n\n  /**\n   * 向左平移\n   * @private\n   */\n  panLeft(distance: number, worldMatrix: Matrix) {\n    const e = worldMatrix.elements;\n    this._vPan.setValue(e[0], e[1], e[2]);\n    this._vPan.scale(distance);\n    this._panOffset.add(this._vPan);\n  }\n\n  /**\n   * 向右平移\n   * @private\n   */\n  panUp(distance: number, worldMatrix: Matrix) {\n    const e = worldMatrix.elements;\n    this._vPan.setValue(e[4], e[5], e[6]);\n    this._vPan.scale(distance);\n    this._panOffset.add(this._vPan);\n  }\n\n  /**\n   * 平移\n   * @property {Number} deltaX x方向的平移量，屏幕距离\n   * @property {Number} deltaY y方向的平移量，屏幕距离\n   */\n  pan(deltaX, deltaY) {\n    const element = this.domElement === document ? this.domElement.body : (this.domElement as HTMLElement);\n\n    // perspective only\n    const position: Vector3 = this.camera.position;\n    position.cloneTo(this._vPan);\n    this._vPan.subtract(this.target);\n    let targetDistance = this._vPan.length();\n\n    targetDistance *= (this.fov / 2) * (Math.PI / 180);\n\n    this.panLeft(-2 * deltaX * (targetDistance / element.clientHeight), this.camera.transform.worldMatrix);\n    this.panUp(2 * deltaY * (targetDistance / element.clientHeight), this.camera.transform.worldMatrix);\n  }\n\n  /**\n   * 放大\n   * @private\n   */\n  zoomIn(zoomScale) {\n    // perspective only\n    this._scale *= zoomScale;\n  }\n\n  /**\n   * 缩小\n   * @private\n   */\n  zoomOut(zoomScale) {\n    // perspective only\n    this._scale /= zoomScale;\n  }\n\n  /**\n   * 鼠标点击时旋转参数更新\n   * @private\n   */\n  handleMouseDownRotate(event) {\n    this._rotateStart.setValue(event.clientX, event.clientY);\n  }\n\n  /**\n   * 鼠标点击时缩放参数更新\n   * @private\n   */\n  handleMouseDownZoom(event) {\n    this._zoomStart.setValue(event.clientX, event.clientY);\n  }\n\n  /**\n   * 鼠标点击时平移参数更新\n   * @private\n   */\n  handleMouseDownPan(event) {\n    this._panStart.setValue(event.clientX, event.clientY);\n  }\n\n  /**\n   * 鼠标移动时旋转参数更新\n   * @private\n   */\n  handleMouseMoveRotate(event) {\n    this._rotateEnd.setValue(event.clientX, event.clientY);\n    Vector2.subtract(this._rotateEnd, this._rotateStart, this._rotateDelta);\n\n    const element = this.domElement === document ? document.body : (this.domElement as HTMLElement);\n\n    this.rotateLeft(2 * Math.PI * (this._rotateDelta.x / element.clientWidth) * this.rotateSpeed);\n    this.rotateUp(2 * Math.PI * (this._rotateDelta.y / element.clientHeight) * this.rotateSpeed);\n\n    this._rotateEnd.cloneTo(this._rotateStart);\n  }\n\n  /**\n   * 鼠标移动时缩放参数更新\n   * @private\n   */\n  handleMouseMoveZoom(event) {\n    this._zoomEnd.setValue(event.clientX, event.clientY);\n    Vector2.subtract(this._zoomEnd, this._zoomStart, this._zoomDelta);\n\n    if (this._zoomDelta.y > 0) {\n      this.zoomOut(this.getZoomScale());\n    } else if (this._zoomDelta.y < 0) {\n      this.zoomIn(this.getZoomScale());\n    }\n\n    this._zoomEnd.cloneTo(this._zoomStart);\n  }\n\n  /**\n   * 鼠标移动时平移参数更新\n   * @private\n   */\n  handleMouseMovePan(event: MouseEvent): void {\n    this._panEnd.setValue(event.clientX, event.clientY);\n    Vector2.subtract(this._panEnd, this._panStart, this._panDelta);\n\n    this.pan(this._panDelta.x, this._panDelta.y);\n\n    this._panEnd.cloneTo(this._panStart);\n  }\n\n  /**\n   * 鼠标滚轮滚动时缩放参数更新\n   * @private\n   */\n  handleMouseWheel(event: MouseWheelEvent): void {\n    if (event.deltaY < 0) {\n      this.zoomIn(this.getZoomScale());\n    } else if (event.deltaY > 0) {\n      this.zoomOut(this.getZoomScale());\n    }\n  }\n\n  /**\n   * 键盘按下时平移参数更新\n   * @private\n   */\n  handleKeyDown(event: KeyboardEvent) {\n    switch (event.keyCode) {\n      case this.keys.UP:\n        this.pan(0, this.keyPanSpeed);\n        break;\n      case this.keys.BOTTOM:\n        this.pan(0, -this.keyPanSpeed);\n        break;\n      case this.keys.LEFT:\n        this.pan(this.keyPanSpeed, 0);\n        break;\n      case this.keys.RIGHT:\n        this.pan(-this.keyPanSpeed, 0);\n        break;\n    }\n  }\n\n  /**\n   * 触摸落下时旋转参数更新\n   * @private\n   */\n  handleTouchStartRotate(event: TouchEvent) {\n    this._rotateStart.setValue(event.touches[0].pageX, event.touches[0].pageY);\n  }\n\n  /**\n   * 触摸落下时缩放参数更新\n   * @private\n   */\n  handleTouchStartZoom(event: TouchEvent) {\n    const dx = event.touches[0].pageX - event.touches[1].pageX;\n    const dy = event.touches[0].pageY - event.touches[1].pageY;\n\n    const distance = Math.sqrt(dx * dx + dy * dy);\n\n    this._zoomStart.setValue(0, distance);\n  }\n\n  /**\n   * 触摸落下时平移参数更新\n   * @private\n   */\n  handleTouchStartPan(event: TouchEvent) {\n    this._panStart.setValue(event.touches[0].pageX, event.touches[0].pageY);\n  }\n\n  /**\n   * 触摸移动时旋转参数更新\n   * @private\n   */\n  handleTouchMoveRotate(event: TouchEvent) {\n    this._rotateEnd.setValue(event.touches[0].pageX, event.touches[0].pageY);\n    Vector2.subtract(this._rotateEnd, this._rotateStart, this._rotateDelta);\n\n    const element = this.domElement === document ? this.domElement.body : (this.domElement as HTMLElement);\n\n    this.rotateLeft(((2 * Math.PI * this._rotateDelta.x) / element.clientWidth) * this.rotateSpeed);\n    this.rotateUp(((2 * Math.PI * this._rotateDelta.y) / element.clientHeight) * this.rotateSpeed);\n\n    this._rotateEnd.cloneTo(this._rotateStart);\n  }\n\n  /**\n   * 触摸移动时缩放参数更新\n   * @private\n   */\n  handleTouchMoveZoom(event) {\n    const dx = event.touches[0].pageX - event.touches[1].pageX;\n    const dy = event.touches[0].pageY - event.touches[1].pageY;\n\n    const distance = Math.sqrt(dx * dx + dy * dy);\n\n    this._zoomEnd.setValue(0, distance);\n\n    Vector2.subtract(this._zoomEnd, this._zoomStart, this._zoomDelta);\n\n    if (this._zoomDelta.y > 0) {\n      this.zoomIn(this.getZoomScale());\n    } else if (this._zoomDelta.y < 0) {\n      this.zoomOut(this.getZoomScale());\n    }\n\n    this._zoomEnd.cloneTo(this._zoomStart);\n  }\n\n  /**\n   * 触摸移动时平移参数更新\n   * @private\n   */\n  handleTouchMovePan(event: TouchEvent) {\n    this._panEnd.setValue(event.touches[0].pageX, event.touches[0].pageY);\n\n    Vector2.subtract(this._panEnd, this._panStart, this._panDelta);\n\n    this.pan(this._panDelta.x, this._panDelta.y);\n\n    this._panEnd.cloneTo(this._panStart);\n  }\n\n  /**\n   * 鼠标按下事件总处理\n   * @private\n   */\n  onMouseDown(event: MouseEvent) {\n    if (this.enabled === false) return;\n\n    event.preventDefault();\n\n    this._isMouseUp = false;\n\n    switch (event.button) {\n      case this.mouseButtons.ORBIT:\n        if (this.enableRotate === false) return;\n\n        this.handleMouseDownRotate(event);\n        this._state = this.STATE.ROTATE;\n        break;\n\n      case this.mouseButtons.ZOOM:\n        if (this.enableZoom === false) return;\n\n        this.handleMouseDownZoom(event);\n        this._state = this.STATE.ZOOM;\n        break;\n\n      case this.mouseButtons.PAN:\n        if (this.enablePan === false) return;\n\n        this.handleMouseDownPan(event);\n        this._state = this.STATE.PAN;\n        break;\n    }\n\n    if (this._state !== this.STATE.NONE) {\n      const element = this.domElement === document ? this.domElement.body : this.domElement;\n      this.mainElement.addEventListener(this.mouseUpEvents[0].type, this.mouseUpEvents[0].listener, false);\n      element.addEventListener(this.mouseUpEvents[1].type, this.mouseUpEvents[1].listener, false);\n    }\n  }\n\n  /**\n   * 鼠标移动事件总处理\n   * @private\n   */\n  onMouseMove(event: MouseEvent) {\n    if (this.enabled === false) return;\n\n    event.preventDefault();\n\n    switch (this._state) {\n      case this.STATE.ROTATE:\n        if (this.enableRotate === false) return;\n\n        this.handleMouseMoveRotate(event);\n        break;\n\n      case this.STATE.ZOOM:\n        if (this.enableZoom === false) return;\n\n        this.handleMouseMoveZoom(event);\n        break;\n\n      case this.STATE.PAN:\n        if (this.enablePan === false) return;\n\n        this.handleMouseMovePan(event);\n        break;\n    }\n  }\n\n  /**\n   * 鼠标抬起事件总处理\n   * @private\n   */\n  onMouseUp() {\n    if (this.enabled === false) return;\n\n    this._isMouseUp = true;\n\n    this.mouseUpEvents.forEach((ele) => {\n      const element = this.domElement === document ? this.domElement.body : this.domElement;\n      element.removeEventListener(ele.type, ele.listener, false);\n      this.mainElement.removeEventListener(ele.type, ele.listener, false);\n    });\n\n    this._state = this.STATE.NONE;\n  }\n\n  /**\n   * 鼠标滚轮滚动事件处理\n   * @private\n   */\n  onMouseWheel(event: MouseWheelEvent) {\n    if (\n      this.enabled === false ||\n      this.enableZoom === false ||\n      (this._state !== this.STATE.NONE && this._state !== this.STATE.ROTATE)\n    )\n      return;\n\n    event.preventDefault();\n    event.stopPropagation();\n\n    this.handleMouseWheel(event);\n  }\n\n  /**\n   * 键盘按下事件总处理\n   * @private\n   */\n  onKeyDown(event: KeyboardEvent) {\n    if (this.enabled === false || this.enableKeys === false || this.enablePan === false) return;\n\n    this.handleKeyDown(event);\n  }\n\n  /**\n   * 触摸按下事件总处理\n   * @private\n   */\n  onTouchStart(event: TouchEvent) {\n    if (this.enabled === false) return;\n\n    this._isMouseUp = false;\n\n    switch (event.touches.length) {\n      case this.touchFingers.ORBIT:\n        if (this.enableRotate === false) return;\n\n        this.handleTouchStartRotate(event);\n        this._state = this.STATE.TOUCH_ROTATE;\n\n        break;\n\n      case this.touchFingers.ZOOM:\n        if (this.enableZoom === false) return;\n\n        this.handleTouchStartZoom(event);\n        this._state = this.STATE.TOUCH_ZOOM;\n\n        break;\n\n      case this.touchFingers.PAN:\n        if (this.enablePan === false) return;\n\n        this.handleTouchStartPan(event);\n        this._state = this.STATE.TOUCH_PAN;\n\n        break;\n\n      default:\n        this._state = this.STATE.NONE;\n    }\n  }\n\n  /**\n   * 触摸移动事件总处理\n   * @private\n   */\n  onTouchMove(event: TouchEvent) {\n    if (this.enabled === false) return;\n\n    event.preventDefault();\n    event.stopPropagation();\n\n    switch (event.touches.length) {\n      case this.touchFingers.ORBIT:\n        if (this.enableRotate === false) return;\n        if (this._state !== this.STATE.TOUCH_ROTATE) return;\n        this.handleTouchMoveRotate(event);\n\n        break;\n\n      case this.touchFingers.ZOOM:\n        if (this.enableZoom === false) return;\n        if (this._state !== this.STATE.TOUCH_ZOOM) return;\n        this.handleTouchMoveZoom(event);\n\n        break;\n\n      case this.touchFingers.PAN:\n        if (this.enablePan === false) return;\n        if (this._state !== this.STATE.TOUCH_PAN) return;\n        this.handleTouchMovePan(event);\n\n        break;\n\n      default:\n        this._state = this.STATE.NONE;\n    }\n  }\n\n  /**\n   * 触摸抬起事件总处理\n   * @private\n   */\n  onTouchEnd() {\n    if (this.enabled === false) return;\n\n    this._isMouseUp = true;\n    this._state = this.STATE.NONE;\n  }\n\n  /**\n   * 上下文事件隐藏\n   * @private\n   */\n  onContextMenu(event) {\n    if (this.enabled === false) return;\n    event.preventDefault();\n  }\n}\n"],"names":["ESP","MathUtil","zeroTolerance","includes","array","filterArray","some","e","indexOf","tween","Tween","FreeControl","entity","_forward","Vector3","_right","camera","mainElement","domElement","movementSpeed","rotateSpeed","floorMock","floorY","jumpY","jumpDuration","press","keysForward","keysBackward","keysLeft","keysRight","keysJump","_theta","_phi","_moveForward","_moveBackward","_moveLeft","_moveRight","_moveJump","_v3Cache","_spherical","_rotateOri","_events","tempVec3","scene","engine","canvas","_webCanvas","document","Spherical","type","listener","onMouseMove","bind","onMouseDown","onMouseUp","onKeyDown","element","window","onKeyUp","onContextMenu","initEvents","updateSpherical","event","preventDefault","code","key","keyCode","jump","stopPropagation","changedTouches","focus","clientX","clientY","enabled","movementX","movementY","factorX","width","factorY","height","actualX","actualY","rotate","alpha","beta","degreeToRadian","clamp","Math","PI","theta","phi","setToVec3","add","position","transform","lookAt","p","doTransform","Translate","x","z","easing","Easing","easeOutSine","onComplete","easeInSine","start","axis","distance","v3","diff","normalize","scale","delta","actualMoveSpeed","getWorldForward","getWorldRight","translateOnAxis","update","setValue","forEach","ele","addEventListener","removeEventListener","transformByQuat","rotation","setFromVec3","Script","OrbitControl","fov","target","up","minDistance","maxDistance","minZoom","maxZoom","enableDamping","zoomFactor","enableRotate","keyPanSpeed","minPolarAngle","maxPolarAngle","minAzimuthAngle","maxAzimuthAngle","enableZoom","dampingFactor","zoomSpeed","enablePan","autoRotate","autoRotateSpeed","enableKeys","keys","mouseButtons","touchFingers","_position","_offset","_sphericalDelta","_sphericalDump","_zoomFrag","_scale","_panOffset","_isMouseUp","_vPan","constEvents","_state","_rotateStart","_rotateEnd","_rotateDelta","_panStart","_panEnd","_panDelta","_zoomStart","_zoomEnd","_zoomDelta","STATE","mouseUpEvents","Infinity","LEFT","UP","RIGHT","BOTTOM","ORBIT","ZOOM","PAN","Vector2","NONE","ROTATE","TOUCH_ROTATE","TOUCH_ZOOM","TOUCH_PAN","onMouseWheel","onTouchStart","onTouchMove","onTouchEnd","body","dtime","cloneTo","subtract","rotateLeft","getAutoRotationAngle","max","min","makeSafe","radius","set","pow","radian","worldMatrix","elements","deltaX","deltaY","targetDistance","length","panLeft","clientHeight","panUp","zoomScale","clientWidth","rotateUp","y","zoomOut","getZoomScale","zoomIn","pan","touches","pageX","pageY","dx","dy","sqrt","button","handleMouseDownRotate","handleMouseDownZoom","handleMouseDownPan","handleMouseMoveRotate","handleMouseMoveZoom","handleMouseMovePan","handleMouseWheel","handleKeyDown","handleTouchStartRotate","handleTouchStartZoom","handleTouchStartPan","handleTouchMoveRotate","handleTouchMoveZoom","handleTouchMovePan"],"mappings":"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"}